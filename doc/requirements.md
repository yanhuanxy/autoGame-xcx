# 项目需求文档: autoGame-LZ

## 1. 项目目标

开发一个自动化脚本，用于在桌面应用程序"聊斋搜神记"中执行一系列日常任务，以减少重复性的人工操作。

## 2. 核心需求

### 2.1. 目标应用识别

-   **R1.1**: 程序启动后，必须能自动查找当前系统中运行的，名称为"聊斋搜神记"的应用程序窗口。
-   **R1.2**: 找到目标窗口后，程序需要将其激活，确保后续操作在该窗口上执行。
-   **R1.3**: 如果未找到目标窗口，程序应给出明确提示并安全退出。

### 2.2. 主界面元素定位

-   **R2.1**: 在游戏主界面，程序需要能够根据预定义的坐标数据`ele_coords`，定位主界面上的功能入口，例如：
    -   `试炼`
    -   `BOSS`
    -   `历练`
    -   `时空`
    -   `修仙`
    -   `仙缘`
    -   `宗门`
    -   `酆都`
-   **R2.2**: 获取到坐标后，需要将这些坐标信息提供给相应的自动化模块使用。

### 2.3. 模块化自动化流程

项目需要划分为多个独立的自动化模块，每个模块对应一项具体任务。

-   **R3.1: 试炼模块**
    -   触发条件：点击主界面的"试炼"坐标。
    -   后续操作：在进入"试炼"界面后，查找并识别"鬼影迷境"字样。

-   **R3.2: BOSS模块**
    -   触发条件：点击主界面的"BOSS"坐标。
    -   后续操作：在进入"BOSS"界面后，查找并识别"修仙BOSS"字样。

-   **R3.3: 历练模块**
    -   触发条件：点击主界面的"历练"坐标。
    -   后续操作：在进入"历练"界面后，查找并识别"云游"字样。

-   **R3.4: 时空模块**
    -   触发条件：点击主界面的"时空"坐标。
    -   后续操作：在进入"时空"界面后，查找并识别"时空之门"字样。

### 2.4. 项目扩展性

-   **R4.1**: 需要创建一个名为"日常"的模块作为占位符。
-   **R4.2**: 该模块初期无需实现具体功能，但整体代码架构需要考虑未来能够方便地向该模块中添加新的自动化任务。

## 3. UI元素路由

-   **R5.1: 静态坐标管理**
    -   系统需维护一个包含预定义UI元素坐标的静态数据结构。
    -   此数据结构将游戏中的主要功能按钮（如"试炼"、"BOSS"等）映射到其在屏幕上的精确多边形坐标。
    -   具体数据参考 “4. 附录：UI元素坐标”。

-   **R5.2: 元素点击路由**
    -   程序需要提供一个路由功能，该功能接收一个元素名称（例如 "试炼"）作为输入。
    -   该功能应能在坐标数据中查找到对应元素的坐标。
    -   根据查找到的坐标，计算出元素的中心点，并模拟鼠标点击操作。
    -   这将作为触发相应自动化模块（如 `trial.py`）的主要导航方式。

## 4. 附录：UI元素坐标

本文档中提到的UI元素坐标数据结构如下：

```json
{
    "group_info": {
        "offset_top": 20,
        "children":{
            "召唤活动": [[[[20.0, 227.0], [60.0, 226.0], [60.0, 237.0], [20.0, 237.0]]], ["召唤活动", 0.02067321105888664]],
            "福利":  [[[[76.0, 225.0], [95.0, 225.0], [95.0, 237.0], [76.0, 237.0]]], ["福利", 0.13975436195798352]],
            "限时活动": [[[[117.0, 225.0], [155.0, 226.0], [155.0, 237.0], [117.0, 237.0]]], ["限时活动", 0.9486657575971567]],
            "聚宝盆": [[[[170.0, 226.0], [202.0, 226.0], [202.0, 238.0], [170.0, 238.0]]], ["聚宝盆", 0.11663112824825982]],
            "精彩活动": [[[[162.0, 275.0], [204.0, 275.0], [204.0, 287.0], [162.0, 286.0]]], ["精移活动", 0.8843474726875166]],
            "小师妹": [[[[18.0, 322.0], [69.0, 322.0], [69.0, 336.0], [18.0, 336.0]]], ["小师妹", 0.4091267559402413]]
        }
    },
    "group_role": {
        "offset_top": 20,
        "children":{
            "修仙": [[[[34.0, 800.0], [76.0, 800.0], [76.0, 820.0], [34.0, 820.0]]], ["修仙", 0.9973089119370044]],
            "角色": [[[[108.0, 811.0], [135.0, 811.0], [135.0, 825.0], [108.0, 825.0]]], ["角色", 0.9992919588309519]],
            "锻造": [[[[162.0, 812.0], [188.0, 811.0], [188.0, 825.0], [162.0, 825.0]]], ["锻造", 0.9977091663914628]],
            "法宝": [[[[220.0, 812.0], [247.0, 812.0], [247.0, 826.0], [220.0, 826.0]]], ["法宝", 0.9990173179211581]],
            "仙术": [[[[274.0, 812.0], [303.0, 812.0], [303.0, 826.0], [274.0, 826.0]]], ["仙术", 0.9982613742936657]],
            "神将": [[[[401.0, 800.0], [442.0, 800.0], [442.0, 820.0], [401.0, 820.0]]], ["神将", 0.9995928143909474]]
        }
    },
    "group_relation": {
        "offset_top": 20,
        "children": {
            "炼妖": [[[[66.0, 741.0], [77.0, 740.0], [78.0, 752.0], [66.0, 752.0]]], ["炼妖", 0.9443567395210266]],
            "幻形": [[[[105.0, 741.0], [128.0, 741.0], [128.0, 752.0], [105.0, 752.0]]], ["幻形", 0.9988284451874421]],
            "魂灵": [[[[154.0, 738.0], [177.0, 739.0], [176.0, 752.0], [154.0, 751.0]]], ["魂灵", 0.9637698384941942]],
            "神物": [[[[205.0, 740.0], [227.0, 740.0], [227.0, 752.0], [205.0, 751.0]]], ["神物", 0.9887276810829775]],
            "仙缘": [[[[254.0, 740.0], [274.0, 740.0], [274.0, 753.0], [234.0, 753.0]]], ["仙缘", 0.2911613274744873]],
            "宗门": [[[[304.0, 738.0], [324.0, 738.0], [324.0, 752.0], [304.0, 752.0]]], ["宗门", 0.2911613274744873]],
            "酆都": [[[[354.0, 741.0], [375.0, 742.0], [375.0, 754.0], [354.0, 753.0]]], ["都都", 0.8295321500312269]]
        }
    },
    "group_combat":{
        "offset_top": 0,
        "children":{
            "日常": [[[[423.0, 401.0], [449.0, 401.0], [449.0, 416.0], [423.0, 416.0]]], ["日常", 0.9989221158659944]],
            "试炼": [[[[423.0, 445.0], [450.0, 445.0], [449.0, 461.0], [422.0, 461.0]]], ["试炼", 0.4778505560520614]],
            "BOOS": [[[[423.0, 491.0], [456.0, 491.0], [456.0, 503.0], [423.0, 503.0]]], ["BOSS", 0.9991261088709036]],
            "历练": [[[[418.0, 532.0], [449.0, 532.0], [449.0, 548.0], [418.0, 548.0]]], ["历练", 0.9962430502276902]],
            "时空": [[[[417.0, 576.0], [449.0, 577.0], [449.0, 593.0], [417.0, 592.0]]], ["时空", 0.9988197831827534]]
        }
    }
}
```
